# Donation List Rune

Introduce this new rune :

### lib/runes.svelte.ts

~~~typescript
... 
export const donations = $state({currentDonations: [] as Donation[]});
~~~

This is a new rune which will hold the list of currently known (on the client) donations.

Now, refactor DonationList to use this instead of accepting the donation list as a property:

~~~html
<script lang="ts">
  import { donations } from "$lib/runes.svelte";

  // let { donations } = $props();
</script>

<table class="table is-fullwidth">
  <thead>
    <tr>
      <th>Amount</th>
      <th>Method</th>
      <th>Candidate</th>
      <th>Donor</th>
    </tr>
  </thead>
  <tbody>
    {#each donations.currentDonations as donation}
      <tr>
        <td>
          {donation.amount}
        </td>
        <td>
          {donation.method}
        </td><td>
          {donation.candidate.lastName}, {donation.candidate.firstName}
        </td>
        <td>
          {donation.donor.lastName}, {donation.donor.firstName}
        </td>
      </tr>
    {/each}
  </tbody>
</table>
~~~

This shows some red 'squiggles' - meaning type errors in this case. Leave these for the moment. 

We will need to adjust report route to follow on from the above change:

### Routes/report/+page.svelte

~~~html
<script lang="ts">
  import Card from "$lib/ui/Card.svelte";
  import DonationList from "$lib/ui/DonationList.svelte";
  import { latestDonations, loggedInUser, subTitle } from "$lib/runes.svelte";
  import { donationService } from "$lib/services/donation-service";
  import { onMount } from "svelte";

  subTitle.text = "Donation to Date";

  onMount(async () => {
    latestDonations.donations = await donationService.getDonations(loggedInUser.token);
  });
</script>

<Card title="Donations">
  <DonationList />
</Card>
~~~

Finally, in DonateForm, once a donation has been made, request all of the latest donations:

### routes/donate/+page.svelte

~~~typescript
        ...
        message = `Thanks! You donated ${amount} to ${candidate.firstName} ${candidate.lastName}`;
        latestDonations.donations = await donationService.getDonations(loggedInUser.token);
        ...
~~~

Running this now, we should see the list of donations updated as we make them:

![](img/30.png)
